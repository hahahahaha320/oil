在es中，每秒清空一次写缓存，将这些数据写入文件，这个过程称为refresh，每次refresh会创建一个新的lucene端。分段数量太多会带来麻烦，消耗文件句柄、内存，影响查询速度。所以需要一定的策略将这些较小的段合并为大的段。
HBase、Cassandra等系统都有类似的分段机制，写过程中现在内存缓冲一批数据，不时地将这些数据写入文件作为一个分段，分段具有不变形，再通过一些策略合并分段。分段合并过程中，新段的产生需要一定的磁盘空间，如果段文件大小没有上限，超过磁盘空间的一半，剩余空间不足以进行新的段合并过程。而如果段文件设置一定上限不再合并，则对表中部分数据无法实现真正的物理删除。ES，Cassandra都存在这样的问题。
分布式系统的集群大致可分为主从模式和无主模式，ES，HDFS，HBase使用主从模式，Cassandra使用无主模式。

集群健康状态：
Green：所有的主、副分片都正常运行
Yellow：所有的主分片都正常运行，但不是所有的副分片都正常运行。
Red：有主分片没能正常运行。32